<!DOCTYPE html>
<html>
<head>
    <title>Silent Order Post Integration Guide</title>
    
        <meta http-equiv="refresh" content="0; url=https://docs.cielo.com.br/gateway-en/docs/silent-order-post">
        <link rel="canonical" href="https://docs.cielo.com.br/gateway-en/docs/silent-order-post" />
    
</head>
<body>
    <h1>Silent Order Post Integration Guide</h1>
    <h3> Redirecionando para <a href="https://docs.cielo.com.br/gateway-en/docs/silent-order-post">https://docs.cielo.com.br/gateway-en/docs/silent-order-post</a> ...</h3>
    <script>location='https://docs.cielo.com.br/gateway-en/docs/silent-order-post'</script>
    <h1 id="silent-order-post">Silent Order Post</h1>

<p>Integration that Braspag offers to retailers, where payment data is securely trafficked, maintaining complete control over the checkout experience.</p>

<p>This method enables you to securely send your customer payment data directly to our system. Payment data such as card number and expiration date are stored in the Braspag environment, which is PCI DSS 3.2 certified.</p>

<p>It is ideal for retailers who demand a high degree of security without losing the identity of their page, allowing full customization on their checkout page.</p>

<h1 id="features">Features</h1>

<ul>
  <li>Capture payment data directly to Braspag systems through the fields defined in your checkout using a javascript script.</li>
  <li>Compatibility with all payment methods available at the Pagador’s gateway (National and International)</li>
  <li>PCI DSS scope reduction</li>
  <li>Maintain full control over the checkout experience while maintaining your brand’s look &amp; feel.</li>
</ul>

<h1 id="transactional-flow">Transactional Flow</h1>

<p><img src="https://braspag.github.io//images/fluxo-sop-br.jpg" alt="Silent Order Post Flux" /></p>

<h1 id="integration">Integration</h1>

<h2 id="1-getting-access-token-oauth2">1. Getting Access Token OAuth2</h2>

<p>When the shopper accesses the checkout, the merchant must generate the AccessToken from Braspag Authentication API (oAuth). On success, the API will return an AccessToken that must be populated in the script to load on the page.</p>

<p>To request AccessToken, send a request (POST) to the following endpoint in the server-to-server template:</p>

<table>
  <thead>
    <tr>
      <th>Environment</th>
      <th>base URL + endpoint</th>
      <th>Authorization</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>SANDBOX</strong></td>
      <td>https://authsandbox.braspag.com.br/oauth2/token</td>
      <td>“Basic <em>{base64}</em>”</td>
    </tr>
    <tr>
      <td><strong>PRODUCTION</strong></td>
      <td>https://auth.braspag.com.br/oauth2/token</td>
      <td>“Basic <em>{base64}</em>”</td>
    </tr>
  </tbody>
</table>

<p>How to obtain the Base64 value:</p>

<ol>
  <li>Concatenate “ClientId” and “ClientSecret” (<code class="language-plaintext highlighter-rouge">ClientId:ClientSecret</code>).</li>
  <li>Code the result in base64.</li>
  <li>Send a request to the authorization server with the alphanumeric code you just created.</li>
</ol>

<blockquote>
  <p>To request your “ClientID” and “ClientSecret”, please contact our <a href="https://suporte.braspag.com.br/hc/pt-br" target="_blank">Support</a>:</p>
  <ul>
    <li>MerchantId;</li>
    <li>Describe that you need the credentials “ClientID” e o “ClientSecret” to use Silent Order Post.</li>
  </ul>
</blockquote>

<h3 id="request">Request</h3>

<aside class="request"><span class="method post">POST</span> <span class="endpoint">oauth2/token</span></aside>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--request</span> POST <span class="s2">"https://authsandbox.braspag.com.br/oauth2/token"</span>
<span class="nt">--header</span> <span class="s2">"Authorization: Basic {base64}"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/x-www-form-urlencoded"</span> 
<span class="nt">--data-binary</span> <span class="s2">"grant_type=client_credentials"</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Parameters</th>
      <th>Format</th>
      <th>Where to send</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Authorization</code></td>
      <td>“Basic <em>{base64}</em>”</td>
      <td>Header.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Content-Type</code></td>
      <td>“application/x-www-form-urlencoded”</td>
      <td>Header.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">grant_type</code></td>
      <td>“client_credentials”</td>
      <td>Body.</td>
    </tr>
  </tbody>
</table>

<h3 id="response">Response</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"faSYkjfiod8ddJxFTU3vti_ ... _xD0i0jqcw"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bearer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">599</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span>
  <span class="s2">"access_token"</span>: <span class="s2">"faSYkjfiod8ddJxFTU3vti_ ... _xD0i0jqcw"</span>,
  <span class="s2">"token_type"</span>: <span class="s2">"bearer"</span>,
  <span class="s2">"expires_in"</span>: 599
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Properties</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">access_token</code></td>
      <td>The requested authentication token, that will be used in the next step.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">token_type</code></td>
      <td>Indicates the token type value.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">expires_in</code></td>
      <td>Access Token expiration, in seconds. When the token expires, you must request a new one.</td>
    </tr>
  </tbody>
</table>

<h2 id="2-getting-the-sop-accesstoken">2. Getting the SOP AccessToken**</h2>

<p>After obtaining AccessToken OAuth2, you should send a new request (POST) to the following URL:</p>

<table>
  <thead>
    <tr>
      <th>Environment</th>
      <th>base URL + endpoint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Sandbox</td>
      <td>https://transactionsandbox.pagador.com.br/post/api/public/v2/accesstoken</td>
    </tr>
    <tr>
      <td>Production</td>
      <td>https://transaction.pagador.com.br/post/api/public/v2/accesstoken</td>
    </tr>
  </tbody>
</table>

<h3 id="request-1">Request</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--request</span> POST <span class="s2">"https://transactionsandbox.pagador.com.br/post/api/public/v2/accesstoken"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"MerchantId: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"</span>
<span class="nt">--header</span> <span class="s2">"Authorization: Bearer faSYkjfiod8ddJxFTU3vti_ ... _xD0i0jqcw"</span>
<span class="nt">--data-binary</span>
<span class="nt">--verbose</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Properties</th>
      <th>Description</th>
      <th>Type</th>
      <th>Size</th>
      <th>Required?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">MerchantId</code></td>
      <td>Merchant identifier at Pagador.</td>
      <td>GUID</td>
      <td>36</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Authorization</code></td>
      <td>Bearer [AccessToken OAuth2]</td>
      <td>Text</td>
      <td>36</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h3 id="response-1">Response</h3>

<p>As a response, you will receive a JSON (“HTTP 201 Created”) with the SOP AccessToken and some other data.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"MerchantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"AccessToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MzA5YWIxNmQtYWIzZi00YmM2LWEwN2QtYTg2OTZjZjQxN2NkMDIzODk5MjI3Mg=="</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Issued"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-05-05T08:50:04"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ExpiresIn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-05-05T09:10:04"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"RequestId: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"</span>
<span class="nt">--data-binary</span>
<span class="o">{</span>
    <span class="s2">"MerchantId"</span>: <span class="s2">"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"</span>,
    <span class="s2">"AccessToken"</span>: <span class="s2">"MzA5YWIxNmQtYWIzZi00YmM2LWEwN2QtYTg2OTZjZjQxN2NkMDIzODk5MjI3Mg=="</span>,
    <span class="s2">"Issued"</span>: <span class="s2">"2021-05-05T08:50:04"</span>,
    <span class="s2">"ExpiresIn"</span>: <span class="s2">"2021-05-05T09:10:04"</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Properties</th>
      <th>Description</th>
      <th>Type</th>
      <th>Size</th>
      <th>Format</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">MerchantId</code></td>
      <td>Merchant identifier at Pagador.</td>
      <td>Guid</td>
      <td>36</td>
      <td>xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">AccessToken</code></td>
      <td>AccessToken SOP. For safety reasons, this token will allow the merchant to save only one card within the deadline determined in the response, through the attribute <em>Expires In</em>. The default is 20 minutes. Whatever happens first will invalidate the token to prevent it from being used again.</td>
      <td>Texto</td>
      <td>–</td>
      <td>NjBhMjY1ODktNDk3YS00NGJkLWI5YTQtYmNmNTYxYzhlNjdiLTQwMzgxMjAzMQ==</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Issued</code></td>
      <td>Token creation date and hour.</td>
      <td>Texto</td>
      <td>–</td>
      <td>AAAA-MM-DDTHH:MM:SS</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ExpiresIn</code></td>
      <td>Token expiration date and hour.</td>
      <td>Texto</td>
      <td>–</td>
      <td>AAAA-MM-DDTHH:MM:SS</td>
    </tr>
  </tbody>
</table>

<aside class="warning">To see the legacy authentication process, which used the MerchantId and shopper IP address to create the `AccessToken`, [click here](https://braspag.github.io//en/manual/silentorderpost#legacy-authentication){:target="_blank"}.</aside>

<h2 id="3-implementing-the-script">3. Implementing the script</h2>

<h3 id="mapping-classes">Mapping Classes</h3>

<p>The establishment must download the script provided by Braspag, and attach it to their checkout page. This script will allow Braspag to process all card information without merchant intervention. The download can be done from the following URL:</p>

<aside class="notice">https://www.pagador.com.br/post/scripts/silentorderpost-1.0.min.js</aside>

<p>The establishment shall parameterize the form elements with the following classes:</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Class Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Credit/Debit Cardholder Name</td>
      <td><strong>bp-sop-cardholdername</strong></td>
    </tr>
    <tr>
      <td>Credit/Debit Card Number</td>
      <td><strong>bp-sop-cardnumber</strong></td>
    </tr>
    <tr>
      <td>Credit/Debit Card Expiration Date</td>
      <td><strong>bp-sop-cardexpirationdate</strong></td>
    </tr>
    <tr>
      <td>Credit/Debit Card Security Code</td>
      <td><strong>bp-sop-cardcvvc</strong></td>
    </tr>
  </tbody>
</table>

<h3 id="setting-parameters">Setting Parameters</h3>

<p><strong>SCRIPT PARAMETERS</strong></p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accessToken</code></td>
      <td>Access Token obtained via Braspag Authentication API</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">environment</code></td>
      <td><strong>sandbox</strong> or <strong>production</strong></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">language</code></td>
      <td><strong>PT</strong> or <strong>EN</strong> or <strong>ES</strong></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">enableBinQuery</code></td>
      <td><strong>true</strong> if you want to enable BIN Query (returns card characteristics). <strong>false</strong> otherwise.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">enableVerifyCard</code></td>
      <td><strong>true</strong> if you want to enable ZeroAuth (returns if the card is valid or not). <strong>false</strong> otherwise.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">enableTokenize</code></td>
      <td><strong>true</strong> if you want to save the card directly on your vault in the Cartão Protegido (retorn a ‘cardToken’ instead of a ‘paymentToken’). <strong>false</strong> otherwise.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">cvvRequired</code></td>
      <td>“false” (unables CVV as required) / “true” (CVV is required).</td>
    </tr>
  </tbody>
</table>

<p><strong>SCRIPT RESPONSE</strong></p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">PaymentToken</code></td>
      <td>Payment Token in the Format of a GUID (36)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">CardToken</code></td>
      <td>Permanent token to be used on a payment request on a GUID format (36) Obs.: Only works if ‘enableTokenize’ is <strong>true</strong></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">brand</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. Card Brand Name (Visa, Master, Bond, Amex, Diners, JCB, Hipercard)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">forerignCard</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. The field returns <strong>true</strong> if it is a card issued outside Brazil. <strong>false</strong> otherwise</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">binQueryReturnCode</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. “00” if BIN parsing is successful.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">binQueryReturnMessage</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. E.g. “Authorized Transaction” if BIN analysis succeeds</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">VerifyCardStatus</code></td>
      <td>Returned when enableVerifyCard option is <strong>true</strong>. Invalid Card 0; 1-Valid Card; 99-Unknown Situation</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">VerifyCardReturnCode</code></td>
      <td>Returned when enableVerifyCard option is <strong>true</strong>. Zero Auth query code returned by the provider.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">BinQueryReturnMessage</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. This is the same code returned by the provider during a standard authorization. E.g.: Cielo30 provider code “00” means validation success</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">BinQueryReturnMessage</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. E.g. “Authorized Transaction”</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">CardBin</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. E.g. “455187”</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">CardLast4Digits</code></td>
      <td>Returned when enableBinQuery option is <strong>true</strong>. E.g. “0181”</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Issuer</code></td>
      <td>Returns the card issuer.</td>
      <td>Returned when <em>enableBinQuery</em> is “true”. Available for Cielo 3.0 only.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">IssuerCode</code></td>
      <td>Returns the card issuer code.</td>
      <td>Returned when <em>enableBinQuery</em> is “true”. Available for Cielo 3.0 only.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">CardType</code></td>
      <td>Returns the card type, E.g.: Credit, Debit, Multiple, Voucher etc.</td>
      <td>Returned when <em>enableBinQuery</em> is “true”. Available for Cielo 3.0 only.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">VerifyCardReturnCode</code></td>
      <td>It is the same code returned by the provider during a standard authorization. E.g.: code “00” for provider Cielo30 means succesful validation.</td>
      <td>Returned when <em>enableBinQuery</em> is “true”. Available for Cielo 3.0 only.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">VerifyCardReturnMessage</code></td>
      <td>E.g.: “Transacao Autorizada”/”Authorized Transaction”.</td>
      <td>Returned when <em>enableBinQuery</em> is “true”. Available for Cielo 3.0 only.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">VerifyCardStatus</code></td>
      <td>“0”- Invalid Card; “1”- Valid Card; “99”- Unknown Situation.</td>
      <td>Returned when <em>enableBinQuery</em> is “true”.</td>
    </tr>
  </tbody>
</table>

<h3 id="implementing-events">Implementing Events</h3>

<p>The script provided by Braspag provides three events for handling and managed by the merchant.</p>

<table>
  <thead>
    <tr>
      <th>Event</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>onSuccess</strong></td>
      <td>Event on success. PaymentToken will be returned, as well as card details if you have requested to verify the card. For security reasons this PaymentToken may only be used for authorization. After processing it will be invalidated.</td>
    </tr>
    <tr>
      <td><strong>onError</strong></td>
      <td>Event on error. Error code and description will be returned</td>
    </tr>
    <tr>
      <td><strong>onInvalid</strong></td>
      <td>Event in case of incorrect data supply. Error field details will be returned. Messages returned in the validation result are available in the following languages: Portuguese (default), English and Spanish.</td>
    </tr>
  </tbody>
</table>

<aside class="notice">For security reasons this PaymentToken may only be used for authorization. After processing it will be invalidated.</aside>

<h3 id="example">Example</h3>

<p>Example of a parameterization on the checkout page:</p>

<p>To download the code, click <a href="https://github.com/Braspag/braspag.github.io/blob/docs/_i18n/pt/_posts/silent-order-post-example.html" target="_blank">here</a></p>

<p><img src="https://braspag.github.io//images/consulta-bin.jpg" alt="Checkout Page" /></p>

<h2 id="4-authorizing-with-paymenttoken">4. Authorizing with PaymentToken</h2>

<p>After obtaining PaymentToken through the script, the authorization process is performed by sending PaymentToken in place of card data.</p>

<p>See example below, describing the submission of authentication data from the Pagador API authorization request.
For more details on implementation, please visit: <a href="https://braspag.github.io//manual/braspag-pagador" target="_blank">Pagador API</a>:</p>

<aside class="request"><span class="method post">POST</span> <span class="endpoint">/v2/sales</span></aside>

<h3 id="request-2">Request</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"MerchantOrderId"</span><span class="p">:</span><span class="s2">"2017051002"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Customer"</span><span class="p">:</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="err">(...)</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"Payment"</span><span class="p">:</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="err">(...)</span><span class="w">
     </span><span class="nl">"Card"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"PaymentToken"</span><span class="p">:</span><span class="s2">"eedcb896-40e1-465b-b34c-6d1119dbb6cf"</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl
<span class="nt">--request</span> POST <span class="s2">"https://apisandbox.braspag.com.br/v2/sales/"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"MerchantId: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--header</span> <span class="s2">"MerchantKey: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--data-binary</span>
<span class="nt">--verbose</span>
<span class="o">{</span>
   <span class="s2">"MerchantOrderId"</span>:<span class="s2">"2017051002"</span>,
   <span class="s2">"Customer"</span>:
   <span class="o">{</span>
     <span class="o">(</span>...<span class="o">)</span>
   <span class="o">}</span>,
   <span class="s2">"Payment"</span>:
   <span class="o">{</span>
     <span class="o">(</span>...<span class="o">)</span>
     <span class="s2">"Card"</span>:<span class="o">{</span>
         <span class="s2">"PaymentToken"</span>:<span class="s2">"eedcb896-40e1-465b-b34c-6d1119dbb6cf"</span>
     <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
      <th>Type</th>
      <th>Size</th>
      <th>Required</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.Card.PaymentToken</code></td>
      <td>Provide the PaymentToken generated through the script. This information replaces the card data</td>
      <td>GUID</td>
      <td>36</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h3 id="response-2">Response</h3>

<p>See https://braspag.github.io/manual/braspag-pagador{:target=”_blank”}</p>

<h1 id="annex">ANNEX</h1>

<h2 id="legacy-authentication">Legacy Authentication</h2>

<h3 id="getting-accesstoken">Getting AccessToken**</h3>

<p>When the shopper accesses the checkout, the merchant must generate AccessToken from the Braspag Authentication API (oAuth). On success, the API will return an AccessToken that must be populated in the script to load on the page.</p>

<p>To request AccessToken, the establishment must POST to the following endpoint in the server-to-server template:</p>

<table>
  <thead>
    <tr>
      <th>Endpoint</th>
      <th>Environment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>https://transactionsandbox.pagador.com.br/post/api/public/v1/accesstoken?merchantid={mid}</td>
      <td>Sandbox</td>
    </tr>
    <tr>
      <td>https://transaction.pagador.com.br/post/api/public/v1/accesstoken?merchantid={mid}</td>
      <td>Production</td>
    </tr>
  </tbody>
</table>

<p>In place of <strong>{mid}</strong> you must fill in the MerchantID of your store in Braspag’s Pagador platform.</p>

<p>Example: https://transactionsandbox.pagador.com.br/post/api/public/v1/accesstoken?merchantid=00000000-0000-0000-0000-000000000000</p>

<h4 id="request-3">Request</h4>

<aside class="request"><span class="method post">POST</span><span class="endpoint">/v1/accesstoken?merchantid={mid}</span></aside>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl
<span class="nt">--request</span> POST <span class="s2">"https://transactionsandbox.pagador.com.br/post/api/public/v1/accesstoken?merchantid=00000000-0000-0000-0000-000000000000"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--data-binary</span>
<span class="nt">--verbose</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>Type</th>
      <th>Size</th>
      <th>Required</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">mid</code></td>
      <td>Payer Store Identifier</td>
      <td>GUID</td>
      <td>36</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h4 id="response-3">Response</h4>

<p>In response, the establishment will receive a json (HTTP 201 Created) containing among other information the ticket (AccessToken)</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"RequestId: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"</span>
<span class="nt">--data-binary</span>
<span class="o">{</span>
    <span class="s2">"MerchantId"</span>: <span class="s2">"B898E624-EF0F-455C-9509-3FAE12FB1F81"</span>,
    <span class="s2">"AccessToken"</span>: <span class="s2">"MzA5YWIxNmQtYWIzZi00YmM2LWEwN2QtYTg2OTZjZjQxN2NkMDIzODk5MjI3Mg=="</span>,
    <span class="s2">"Issued"</span>: <span class="s2">"2019-12-09T17:47:14"</span>,
    <span class="s2">"ExpiresIn"</span>: <span class="s2">"2019-12-09T18:07:14"</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>Type</th>
      <th>Size</th>
      <th>Format</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">MerchantId</code></td>
      <td>Pagador Store Identifier</td>
      <td>GUID</td>
      <td>36</td>
      <td>xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">AccessToken</code></td>
      <td>Access Token. For security reasons, this ticket will give the merchant permission to save only 1 card within the time limit stipulated in the response via the ExpiresIn attribute (by default 20 minutes). Whatever happens first will invalidate this same ticket for future use.</td>
      <td>Text</td>
      <td>–</td>
      <td>NjBhMjY1ODktNDk3YS00NGJkLWI5YTQtYmNmNTYxYzhlNjdiLTQwMzgxMjAzMQ==</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Issued</code></td>
      <td>Date and time of generation</td>
      <td>Text</td>
      <td>–</td>
      <td>AAAA-MM-DDTHH:MM:SS</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ExpiresIn</code></td>
      <td>Expiration Date and Time</td>
      <td>Text</td>
      <td>-</td>
      <td>YYYY-MM-DDTHH:MM:SS</td>
    </tr>
  </tbody>
</table>

<aside class="notice">For security reasons, registration of a valid IP of the establishment in Braspag will be required. Otherwise the request will not be authorized (HTTP 401 NotAuthorized). Please identify which will be the outgoing IP that will access the API and then request the registration through the Braspag service channel: https://suporte.braspag.com.br/hc/en{:target="_blank"}</aside>

</body>
</html>