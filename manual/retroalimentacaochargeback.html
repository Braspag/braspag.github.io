<!DOCTYPE html>
<html lang="pt">
    <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="theme-color" content="#00aeef">
    <meta http-equiv="Content-Language" content="pt">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>
        
        Retroalimentação de Chargeback - Manual de integração &middot; Documentações e tutoriais
        
    </title>

    <link rel="shortcut icon" href="https://braspag.github.io//assets/favicon.ico">

    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
    <script src="https://use.fontawesome.com/3ae06f1030.js"></script>
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/poole.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/syntax.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/hyde.css">

    <link rel="stylesheet" href="https://braspag.github.io//assets/css/bootstrap.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/jquery.tocify.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/jquery-ui.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/prettify.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/custom.css">
    <link rel="stylesheet" href="https://braspag.github.io//assets/css/braspag.css">

    
        
            <link rel="alternate" hreflang="pt" href="https://braspag.github.io//manual/retroalimentacaochargeback" />
        
    
        
            <link rel="alternate" hreflang="en" href="https://braspag.github.io//en/manual/retroalimentacaochargeback" />
        
    

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://braspag.github.io//atom.xml">
</head>

    <body>
        
        <div class="content-container">
            <div class="language-tabs">
                <a class='hide-btn' id="hide-button" title="Comutar"><i class="fa fa-bars" aria-hidden="true"></i></a>
                <ul class="language-buttons">
                    
                    <li><a data-language-name='json'>JSON</a></li>
                    
                    <li><a data-language-name='html'>HTML</a></li>
                    
                </ul>
            </div>
            <div class="dark-box"></div>
            <div class="overlay"></div>
        
            <div id="submenu">
                <div class="submenu-container">
                    <div class="submenu-row sub-items">
                        <div class="submenu-itens">
                            <a href="http://www.braspag.com.br/suporte/" class="help">Ajuda</a>

                            
                        </div>

                        
                        <div class="search">
                            <input type="text" class="search" id="input-search">
                        </div>
                    </div>
                    <div class="submenu-row results">
                        <div class="search-results-container">
                            <ul class="search-results"></ul>
                        </div>
                    </div>
                        

                    <div class="submenu-row breads">
                        <ol class="breadcrumb">
                            
                            <li><a href="/">Início</a></li>
                            
                            
                            
                            
                                
                                    
                                    
                                    
                                    
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                            
                                
                                    
                                    <li class="active">&gt; <a href="https://braspag.github.io//manual/retroalimentacaochargeback">Retroalimentação de Chargeback - Manual de integração</a></li>
                                    
                                
                            
                        </ol>
                    </div>
                </div>
            </div>

            <div class="post">
  <h1 id="visão-geral">Visão Geral</h1>

<p>Retroalimentação de Chargeback é uma API desenvolvida pelo time de Risco da Braspag para os clientes informarem os chargebacks de transações analisadas, proporcionando:</p>

<ul>
  <li>Melhoria na performance das decisões automáticas - Uma vez que dados marcados na transação em que ocorreu o chargeback são adicionados à lista negativa, é possível realizar regras mais rigorosas provendo um ganho na estratégia;</li>
  <li>Maior assertividade para equipes de revisão manual - Quando uma transação é marcada como chargeback, ela recebe um rótulo que fica visível para pesquisas posteriores que incluem pesquisas por “transações similares” (recurso bastante utilizado por equipes de revisão manual de transações tanto da Cybersource quanto próprias).</li>
</ul>

<p>A API é baseada em arquitetura REST, que trocam dados em formato JSON seguindo fluxos de autorização definidos pelo protocolo OAuth 2, onde todos os padrões são amplamente utilizados pelo mercado e suportado pelas comunidades técnicas.</p>

<blockquote>
  <p>Para saber mais sobre OAuth 2, consulte <a href="https://oauth.net/2/">https://oauth.net/2/</a></p>
</blockquote>

<h1 id="objetivo">Objetivo</h1>

<p>O objetivo desta documentação é orientar o desenvolvedor sobre como integrar com a API Retroalimentação de Chargeback Braspag, descrevendo as operações disponíveis com exemplos de requisições e respostas.</p>

<p>Para executar uma operação, combine o endpoint base do ambiente com o endpoint da operação desejada e envie utilizando o VERBO HTTP conforme descrito na operação.</p>

<h1 id="hosts">Hosts</h1>

<h2 id="api-braspagauth">API BraspagAuth</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Ambiente</th>
      <th style="text-align: left">URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Sandbox</code></td>
      <td style="text-align: left">https:\\authsandbox.braspag.com.br</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Produção</code></td>
      <td style="text-align: left">https:\\auth.braspag.com.br</td>
    </tr>
  </tbody>
</table>

<h2 id="api-retroalimentação-de-chargeback">API Retroalimentação de Chargeback</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Ambiente</th>
      <th style="text-align: left">URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Sandbox</code></td>
      <td style="text-align: left">https:\\chargebacksandbox.braspag.com.br</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Produção</code></td>
      <td style="text-align: left">https:\\chargeback.braspag.com.br</td>
    </tr>
  </tbody>
</table>

<h1 id="autenticação">Autenticação</h1>

<h2 id="tokens-de-acesso">Tokens de Acesso</h2>

<p>A API Retroalimentação de Charegabck Braspag utiliza o protocolo padrão de mercado OAuth 2.0 para autorização de acesso a seus recursos específicos por ambientes, que são: <strong>Sandbox</strong> e <strong>Produção</strong>.</p>

<p>Esta sessão descreve o fluxo necessário para que aplicações cliente obtenham tokens de acesso válidos para uso na API.</p>

<h2 id="obtenção-do-token-de-acesso">Obtenção do token de acesso</h2>

<p>O token de acesso é obtido através do fluxo oauth <strong>client_credentials</strong>. O diagrama abaixo, ilustra, em ordem cronológica, a comunicação que se dá entre a <strong>Aplicação Cliente</strong>, a <strong>API BraspagAuth</strong> e a <strong>API Retroalimentação de Chargeback</strong>.</p>

<ol>
  <li>
    <p>A <strong>Aplicação Cliente</strong>, informa à API <strong>BraspagAuth</strong> sua credencial.</p>
  </li>
  <li>
    <p>O <strong>BraspagAuth</strong> valida a credencial recebida. Se for válida, retorna o token de acesso para a <strong>Aplicação Cliente</strong>.</p>
  </li>
  <li>
    <p>A <strong>Aplicação Cliente</strong> informa o token de acesso no cabeçalho das requisições HTTP feitas à <strong>API Retroalimentação de Charegack</strong>.</p>
  </li>
  <li>
    <p>Se o token de acesso for válido, a requisição é processada e os dados são retornados para a <strong>Aplicação Cliente</strong>.</p>
  </li>
</ol>

<blockquote>
  <p>Solicite uma credencial abrindo um ticket através da nossa ferramenta de suporte, enviando o(s) IP(s) de saída dos seus servidores de homologação e produção.<br />
<a href="https://suporte.braspag.com.br/hc/pt-br">Suporte Braspag</a></p>
</blockquote>

<h2 id="como-obter-o-token">Como obter o token</h2>

<p>Uma vez em posse da credencial, será necessário “codificá-la” em Base64, utilizando a convenção <strong>client_id:client_secret</strong>, e enviar o resultado no cabeçalho através do campo <strong>Authorization</strong>.</p>

<p>Exemplo:</p>
<ul>
  <li>client_id: <strong>braspagtestes</strong></li>
  <li>client_secret: <strong>1q2w3e4r5t6y7u8i9o0p0q9w8e7r6t5y4u3i2o1p</strong></li>
  <li>String a ser codificada em Base64: <strong>braspagtestes:1q2w3e4r5t6y7u8i9o0p0q9w8e7r6t5y4u3i2o1p</strong></li>
  <li>Resultado após a codificação: <strong>YnJhc3BhZ3Rlc3RlczoxcTJ3M2U0cg==</strong></li>
</ul>

<h3 id="request">Request</h3>

<aside class="request"><span class="method post">POST</span> <span class="endpoint">oauth2/token</span></aside>

<p><strong>Parâmetros no cabeçalho (Header)</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Key</th>
      <th style="text-align: left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Content-Type</code></td>
      <td style="text-align: left">application/x-www-form-urlencoded</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Authorization</code></td>
      <td style="text-align: left">Basic YnJhc3BhZ3Rlc3RlczoxcTJ3M2U0cg==</td>
    </tr>
  </tbody>
</table>

<p><strong>Parâmetros no corpo (Body)</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Key</th>
      <th style="text-align: left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">scope</code></td>
      <td style="text-align: left">ChargebackApp</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">grant_type</code></td>
      <td style="text-align: left">client_credentials</td>
    </tr>
  </tbody>
</table>

<h3 id="response">Response</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"faSYkjfiod8ddJxFTU3vti_ ... _xD0i0jqcw"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bearer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">599</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Parâmetros no corpo (Body)</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parâmetro</th>
      <th style="text-align: left">Descrição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">access_token</code></td>
      <td style="text-align: left">O token de acesso solicitado. O aplicativo pode usar esse token para se autenticar no recurso protegido, no caso a API Retroalimentação de Chargeback</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">token_type</code></td>
      <td style="text-align: left">Indica o valor do tipo de token</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">expires_in</code></td>
      <td style="text-align: left">Expiração do o token de acesso, em segundos <br />O token quando expirar, é necessário obter um novo</td>
    </tr>
  </tbody>
</table>

<h1 id="retroalimentando-chargeback-via-api">Retroalimentando chargeback via API</h1>

<h3 id="request-1">Request</h3>

<aside class="request"><span class="method post">POST</span><span class="endpoint">chargeback</span></aside>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"Chargebacks"</span><span class="p">:</span><span class="w">
   </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"Amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"Date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-12-02"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"Comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Esta transação sofreu chargeback relacionada a não reconhecimento de compra por parte do portador do cartão."</span><span class="p">,</span><span class="w">
         </span><span class="s2">"ReasonCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"ReasonMessage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEB NAO REC DE COMPRA"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"IsFraud"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
         </span><span class="s2">"NegativeValues"</span><span class="p">:</span><span class="w">
         </span><span class="p">[</span><span class="w">
            </span><span class="s2">"CustomerIpAddress"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"CustomerDocumentNumber"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="s2">"Transaction"</span><span class="p">:</span><span class="w">
         </span><span class="p">{</span><span class="w">
            </span><span class="s2">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fb647240-824f-e711-93ff-000d3ac03bed"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Tid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789012345678AB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Nsu"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345678"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"AuthorizationCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"SaleDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-10-15"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"BraspagTransactionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a3e08eb2-2144-4e41-85d4-61f1befc7a3b"</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Parâmetros no cabeçalho (Header)</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Key</th>
      <th style="text-align: left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Content-Type</code></td>
      <td style="text-align: left">application/json</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Authorization</code></td>
      <td style="text-align: left">Bearer {access_token}</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">MerchantId</code></td>
      <td style="text-align: left">xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">RequestId</code></td>
      <td style="text-align: left">nnnnnnnn-nnnn-nnnn-nnnn-nnnnnnnnnnnn</td>
    </tr>
  </tbody>
</table>

<p><strong>Parâmetros no corpo (Body)</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parâmetro</th>
      <th style="text-align: left">Descrição</th>
      <th style="text-align: center">Tipo</th>
      <th style="text-align: center">Obrigatório</th>
      <th style="text-align: right">Tamanho</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Amount</code></td>
      <td style="text-align: left">Valor do chargeback <br /> Ex.: 150000 Ex: 123456 = r$ 1.234,56</td>
      <td style="text-align: center">long</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Date</code></td>
      <td style="text-align: left">Data da confirmação do chargeback <br /> Ex.: 2017-12-02</td>
      <td style="text-align: center">date</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Comment</code></td>
      <td style="text-align: left">Comentário que deseja associar ao chargeback que ficará visível no Admin Braspag <br /> Se chargeback de transação Cybersource, este comentário ficará visível no backoffice da Cybersource</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">512</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].ReasonCode</code></td>
      <td style="text-align: left">Código do motivo do chargeback</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">8</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].ReasonMessage</code></td>
      <td style="text-align: left">Mensagem do motivo do chargeback</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">128</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].IsFraud</code></td>
      <td style="text-align: left">Identifica se o chargeback foi por motivo de fraude</td>
      <td style="text-align: center">bool</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].NegativeValues</code></td>
      <td style="text-align: left">Parâmetros que deseja incluir na lista negativa <br /> Os parâmetros que serão incluídos devem ser acordados com o analista de risco da Cybersource, pois pode impactar diretamente na estratégia de risco - <a href="https://braspag.github.io//manual/retroalimentacaochargeback#tabela-1">Tabela 1</a></td>
      <td style="text-align: center">enum</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Transaction.Id</code></td>
      <td style="text-align: left">Id da transação no Antifraude <br /> Este campo se torna obrigatório se o campo <code class="highlighter-rouge">BraspagTransactionId</code> não for enviado e se os campos <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> (todos juntos) não forem enviados</td>
      <td style="text-align: center">Guid</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Transaction.Tid</code></td>
      <td style="text-align: left">Identificador da transação na adquirente <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Nsu</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">20</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Transaction.Nsu</code></td>
      <td style="text-align: left">Número sequencial único da transação na adquirente <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">10</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Transaction.AuthorizationCode</code></td>
      <td style="text-align: left">Código de autorização da transação na adquirente <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code> e <code class="highlighter-rouge">SaleDate</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">10</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Transaction.SaleDate</code></td>
      <td style="text-align: left">Data da venda da transação <br /> Ex.: 2017-10-15 <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code> e <code class="highlighter-rouge">AuthorizationCode</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">date</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Chargebacks[n].Transaction.BraspagTransactionId</code></td>
      <td style="text-align: left">Id da transação no Pagador Braspag <br /> Este campo se torna obrigatório se o campo <code class="highlighter-rouge">AntifraudTransactionId</code> não for enviado e se os campos <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> (todos juntos) não forem enviados</td>
      <td style="text-align: center">Guid</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
  </tbody>
</table>

<h3 id="response-1">Response</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"Chargebacks"</span><span class="p">:</span><span class="w">
   </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"Amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"Date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-12-02"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"Comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Esta transação sofreu chargeback relacionada a não reconhecimento de compra por parte do portador do cartão."</span><span class="p">,</span><span class="w">
         </span><span class="s2">"ReasonCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"ReasonMessage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEB NAO REC DE COMPRA"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"IsFraud"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
         </span><span class="s2">"NegativeValues"</span><span class="p">:</span><span class="w">
         </span><span class="p">[</span><span class="w">
            </span><span class="s2">"CustomerIpAddress"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"CustomerDocumentNumber"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="s2">"Transaction"</span><span class="p">:</span><span class="w">
         </span><span class="p">{</span><span class="w">
            </span><span class="s2">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fb647240-824f-e711-93ff-000d3ac03bed"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Tid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789012345678AB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Nsu"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345678"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"AuthorizationCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"SaleDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-10-15"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"BraspagTransactionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a3e08eb2-2144-4e41-85d4-61f1befc7a3b"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"Result"</span><span class="p">:</span><span class="w">
         </span><span class="p">{</span><span class="w">
            </span><span class="s2">"ProcessingStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NotFound"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"ErrorMessages"</span><span class="p">:</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"Could not find any transaction."</span><span class="w">
            </span><span class="p">]</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Parâmetros no cabeçalho (Header)</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Key</th>
      <th style="text-align: left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Content-Type</code></td>
      <td style="text-align: left">application/json</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Status</code></td>
      <td style="text-align: left">300 Multiple Choices</td>
    </tr>
  </tbody>
</table>

<p><strong>Parâmetros no corpo (Body)</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parâmetro</td>
      <td>Descrição</td>
      <td>Tipo</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">Result.ProcessingStatus</code></td>
      <td>Status do processamento do chargeback - <a href="https://braspag.github.io//manual/retroalimentacaochargeback#tabela-2-result.processingstatus">Tabela 2</a></td>
      <td>enum</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">Result.ErrorMessages</code></td>
      <td>Mensagens de erro para chargebacks não processados</td>
      <td>string</td>
    </tr>
  </tbody>
</table>

<h1 id="retroalimentando-chargeback-via-admin-braspag">Retroalimentando chargeback via Admin Braspag</h1>

<p>Nesta seção será explicado passo a passo como realizar o upload do arquivo de chargeback via Admin Braspag.</p>

<h2 id="passo-1---acessando-o-admin-braspag">Passo 1 - Acessando o Admin Braspag</h2>

<p>Para acessar o Admin Braspag, digitar no browser de sua preferência a URL de acordo com o ambiente desejado, conforme abaixo:</p>

<table>
  <tbody>
    <tr>
      <td>Ambiente</td>
      <td>URL</td>
    </tr>
    <tr>
      <td>Sandbox</td>
      <td>https://adminsandbox.braspag.com.br</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>https://admin.braspag.com.br</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Caso não possua um usuário para o ambiente desejado, solicite a criação do mesmo através da nossa ferramenta de suporte.
<a href="https://suporte.braspag.com.br/hc/pt-br">Suporte Braspag</a></p>
</blockquote>

<h2 id="passo-2---acessando-a-tela-de-upload-de-arquivo-de-chargeback">Passo 2 - Acessando a tela de Upload de Arquivo de Chargeback</h2>

<p>Para realizar o upload do arquivo de chargeback, você deverá acessar a tela através do menu: <code class="highlighter-rouge">Configurações -&gt; Upload de Arquivo de Chargeback</code></p>

<p><img src="https://braspag.github.io//images/braspag/af/acesso.png" alt="Upload de Arquivo de Chargeback" class="centerimg" title="Acessando a tela de Upload de Arquivo de Chargeback" /></p>

<h2 id="passo-3---construindo-o-arquivo-de-chargeback-no-formato-csv">Passo 3 - Construindo o arquivo de chargeback no formato CSV</h2>

<p>Neste passo será explicado como construir um arquivo no formato CSV (Semicolon-separated values - Valores separados por ponto-e-vírgula) com os dados do chargeback.</p>

<p>CSV é um formato de arquivo que contém valores separados por algum delimitador, ponto-e-vígula (;) por exemplo. Pode ser criado em qualquer editor de texto e lido em uma planilha de textos, como por exemplo, o excel. A planilha eletrônica irá dividir em linha/coluna cada item do arquivo separados por ponto-e-vírgula (;).</p>

<p>Você poderá realizar o download de um arquivo de template através da opção disponibilizada na tela de Upload de Arquivo de Chargeback, conforme print abaixo:
<img src="https://braspag.github.io//images/braspag/af/teladownloadtemplatecbk.png" alt="Upload de Arquivo de Chargeback" class="centerimg" title="Download template arquivo CSV" /></p>

<p>O CSV que será construído com dos dados de chargeback deverá ter o layout abaixo, seguindo o tipo e obrigatoriedade de cada campo.</p>
<blockquote>
  <p>Amount;Date;Comment;ReasonCode;ReasonMessage;IsFraud;Id;Tid;Nsu;AuthorizationCode;SaleDate;BraspagTransactionId;NegativeValues</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parâmetro</th>
      <th style="text-align: left">Descrição</th>
      <th style="text-align: center">Tipo</th>
      <th style="text-align: center">Obrigatório</th>
      <th style="text-align: right">Tamanho</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Amount</code></td>
      <td style="text-align: left">Valor do chargeback <br /> Ex.: 150000 Ex: 123456 = r$ 1.234,56</td>
      <td style="text-align: center">long</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Date</code></td>
      <td style="text-align: left">Data da confirmação do chargeback <br /> Ex.: 2017-12-02</td>
      <td style="text-align: center">date</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Comment</code></td>
      <td style="text-align: left">Comentário que deseja associar ao chargeback que ficará visível no Admin Braspag <br /> Se chargeback de transação Cybersource, este comentário ficará visível no backoffice da Cybersource</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">512</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">ReasonCode</code></td>
      <td style="text-align: left">Código do motivo do chargeback</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">8</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">ReasonMessage</code></td>
      <td style="text-align: left">Mensagem do motivo do chargeback</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">sim</td>
      <td style="text-align: right">128</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">IsFraud</code></td>
      <td style="text-align: left">Identifica se o chargeback foi por motivo de fraude</td>
      <td style="text-align: center">bool</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">NegativeValues</code></td>
      <td style="text-align: left">Parâmetros que deseja incluir na lista negativa <br /> Os parâmetros que serão incluídos devem ser acordados com o analista de risco da Cybersource, pois pode impactar diretamente na estratégia de risco - <a href="https://braspag.github.io//manual/retroalimentacaochargeback#tabela-1-chargebacks[n].negativevalues">Tabela 1</a></td>
      <td style="text-align: center">enum</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Id</code></td>
      <td style="text-align: left">Id da transação no Antifraude <br /> Este campo se torna obrigatório se o campo <code class="highlighter-rouge">BraspagTransactionId</code> não for enviado e se os campos <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> (todos juntos) não forem enviados</td>
      <td style="text-align: center">Guid</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Tid</code></td>
      <td style="text-align: left">Identificador da transação na adquirente <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Nsu</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">20</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">Nsu</code></td>
      <td style="text-align: left">Número sequencial único da transação na adquirente <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">10</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">AuthorizationCode</code></td>
      <td style="text-align: left">Código de autorização da transação na adquirente <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code> e <code class="highlighter-rouge">SaleDate</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">10</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">SaleDate</code></td>
      <td style="text-align: left">Data da venda da transação <br /> Ex.: 2017-10-15 <br /> Este campo se torna obrigatório juntamente com <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code> e <code class="highlighter-rouge">AuthorizationCode</code> se os campos <code class="highlighter-rouge">Id</code> e <code class="highlighter-rouge">BraspagTransactionId</code> não forem enviados</td>
      <td style="text-align: center">date</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">BraspagTransactionId</code></td>
      <td style="text-align: left">Id da transação no Pagador Braspag <br /> Este campo se torna obrigatório se o campo <code class="highlighter-rouge">AntifraudTransactionId</code> não for enviado e se os campos <code class="highlighter-rouge">Tid</code>, <code class="highlighter-rouge">Nsu</code>, <code class="highlighter-rouge">AuthorizationCode</code> e <code class="highlighter-rouge">SaleDate</code> (todos juntos) não forem enviados</td>
      <td style="text-align: center">Guid</td>
      <td style="text-align: center">não</td>
      <td style="text-align: right">-</td>
    </tr>
  </tbody>
</table>

<h2 id="passo-4---enviando-o-arquivo-de-chargeback">Passo 4 - Enviando o arquivo de chargeback</h2>

<p>Com o arquivo já construído, e realizando os passos 1 e 2, agora é selecionar o arquivo e enviá-lo, conforme print abaixo:</p>

<p><img src="https://braspag.github.io//images/braspag/af/tela.png" alt="Upload de Arquivo de Chargeback" class="centerimg" title="Tela de Upload de Arquivo de Chargeback" /></p>

<p>1 - Clique no botão <code class="highlighter-rouge">Choose File</code> para selecionar o arquivo na máquina local.<br />
2 - Com o arquivo selecionado, clique no botão <code class="highlighter-rouge">Enviar</code> para realizar o upload do arquivo.</p>

<h2 id="passo-5---verificando-o-resultado-do-envio-do-arquivo-de-chargeback">Passo 5 - Verificando o resultado do envio do arquivo de chargeback</h2>

<p>Após realizar todos os passos acima, o arquivo será processado e através da seção Resultado será possível verificar o resultado do processamento.</p>

<p>Em caso de sucesso, será apresentada a mensagem de <strong>Operação realizada com sucesso</strong> e um ID que é o comprovante do upload do arquivo.</p>

<p>Em caso de alguma falha, será apresentada a mensagem de <strong>Operação parciamente concluída. Favor verificar a seção Resultado</strong> e também um ID que é o comprovante do upload do arquivo, conforme print abaixo:</p>

<p><img src="https://braspag.github.io//images/braspag/af/uploadparcial.png" alt="Upload de Arquivo de Chargeback" class="centerimg" title="Upload parcialmente processado" /></p>

<p>Neste caso, é possível verificar os erros encontrados em cada linha, tratar e reenviar o arquivo.</p>

<h1 id="tabelas">Tabelas</h1>

<h2 id="tabela-1---chargebacksnnegativevalues">Tabela 1 - Chargebacks[n].NegativeValues</h2>

<p>Possíveis valores a serem inseridos na lista negativa na Cybersource.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Valor</th>
      <th style="text-align: left">Descrição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CustomerDocumentNumber</td>
      <td style="text-align: left">Número do documento do comprador, CPF ou CNPJ</td>
    </tr>
    <tr>
      <td style="text-align: left">CustomerIpAddress</td>
      <td style="text-align: left">Endereço de IP do comprador</td>
    </tr>
    <tr>
      <td style="text-align: left">CustomerPhone</td>
      <td style="text-align: left">Número de telefone do comprador</td>
    </tr>
    <tr>
      <td style="text-align: left">ShippingStreet</td>
      <td style="text-align: left">Logradouro do endereço de entrega</td>
    </tr>
    <tr>
      <td style="text-align: left">DeviceFingerprintSmartId</td>
      <td style="text-align: left">Fingerprint do dispositivo do comprador</td>
    </tr>
  </tbody>
</table>

<h2 id="tabela-2---resultprocessingstatus">Tabela 2 - Result.ProcessingStatus</h2>

<p>Possíveis retornos do chargeback enviado.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Valor</th>
      <th style="text-align: left">Descrição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">AlreadyExist</td>
      <td style="text-align: left">Transação já marcada com chargeback anteriormente</td>
    </tr>
    <tr>
      <td style="text-align: left">Remand</td>
      <td style="text-align: left">Chargeback deverá ser reenviado</td>
    </tr>
    <tr>
      <td style="text-align: left">NotFound</td>
      <td style="text-align: left">Transação na encontrada na base de dados para os valores enviados nos campos do nó Transaction</td>
    </tr>
  </tbody>
</table>

</div>


            <div class="footer-conteudo">
    <div id="footer-conteudo-img" class="col-lg-1 col-md-1">
            <img src="https://braspag.github.io//assets/images/icon-doubt.svg" width="55px" height="53px" alt="Precisa de ajuda?">
    </div>

    <div id="footer-conteudo-texto" class="col-lg-11 col-md-11">
        <h2>Precisa de ajuda?</h2>
        <p>Se você não conseguiu encontrar sua resposta acima, <a href="http://www.braspag.com.br/fale-conosco/">entre em contato conosco</a>.</p>
    </div>
</div>

        </div>

        <div class="sidebar">
  <div class="sidebar-sticky">
    <div class="sidebar-about">
      <a title="Comutar a coluna da esquerda" class="hamburger">
        <i class="fa fa-bars hamb-menu" aria-hidden="true"></i>
      </a>
      <a href="https://braspag.github.io//">
        <img src="https://braspag.github.io//assets/images/logo.png" alt="Documentações e tutoriais">
      </a>
      <div></div>
    </div>

    <div id="toc"></div>

    <div class="fixed-footer">
        

    <div class="toc-contact">
      <div class="contact">
        <a title="Contato" href="http://www.braspag.com.br/fale-conosco/">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          <span>Contato</span>
        </a>
      </div>
      <div class="github">
        <a title="GitHub" href="https://github.com/braspag">
          <i class="fa fa-github" aria-hidden="true"></i>
          <span>GitHub</span>
        </a>
      </div>
    </div>
  </div>
  </div>
</div>


        <script src="https://braspag.github.io//assets/js/jquery.min.js"></script>
        <script src="https://braspag.github.io//assets/js/jquery-ui-1.9.1.custom.min.js"></script>
        <script src="https://braspag.github.io//assets/js/bootstrap.js"></script>
        <script src="https://braspag.github.io//assets/js/jquery.tocify.js"></script>
        <script src="https://braspag.github.io//assets/js/prettify.js"></script>
        <script>
        $(function() {
            var openedHeader = null;

            $("#toc").tocify({
                
                selectors: "h1,h2,h3,h4,h5,h6",
                
                hashGenerator: "pretty",
                ignoreSelector: ".no-toc",
                scrollTo: 100,
                smoothScroll: false,
                showEffect: "none"
            }).data("toc-tocify");

            $('ul').prev('li').addClass('has-subitens');
            $(window).scroll(function () {
                if ($('li.active').closest('.tocify-header') !== openedHeader) {
                    $('li.is-open').removeClass('is-open');

                    openedHeader = $('li.active').closest('.tocify-header');
                }

                openedHeader.find('ul:visible').prev('li').addClass('is-open');
            });

            $('.hamburger').click(function() {
                $('body').toggleClass('sidebar-closed');
            });

            $('.code-menu').click(function() {
                $('body').toggleClass('code-menu-closed');
            });

            prettyPrint();
        });
        </script>

        
        <script src="https://braspag.github.io//assets/js/jquery.highlight.js"></script>
        <script src="https://braspag.github.io//assets/js/lunr.js"></script>
        <script src="https://braspag.github.io//assets/js/search.js"></script>
        

        
        <script>
        let langs = '';

        $('div.highlighter-rouge').prepend( '<a class="fa expand-btn" title="Comutar"><i class="fa fa-expand" aria-hidden=true></i></a>' );
        $('div.highlighter-rouge').each(function (index) {
            if(!$(this).parent().hasClass('language-group')) {
                $(this).first().next('div.highlighter-rouge').andSelf().wrapAll('<div class="code-fullscreen"><div class="language-group"></div></div>');
            }
        });

        $('.content-container:not(.no-dark-box) div.highlighter-rouge').each(function (index) {
            let height = $(this).outerHeight();

            $(this).parent().parent().next('table').wrapAll('<div class="table-wrap" style="min-height:' + height + 'px;"></div> ');
        });

        $('.hide-btn').click(function() {
            $('.content-container').toggleClass('no-dark-box');
            $('.dark-box').toggle();

            $('.overlay').removeClass('opened');
            $('.code-fullscreen').removeClass('opened');
        });

        $('.expand-btn').click(function() {
            $('.overlay').toggleClass('opened');
            $(this).parent().parent().parent().toggleClass('opened');
            $(this).children('i.fa').toggleClass('fa-compress');
        });

        
        langs += "<a data-language-name='json'>JSON</a>";
        
        langs += "<a data-language-name='html'>HTML</a>";
        

        $('.language-group').prepend('<div class="language-buttons">' + langs + '</div>');
        </script>

        <script src="https://braspag.github.io//assets/js/lang.js"></script>
        <script>
            $(function() {
                setupLanguages([  "json",  "html", ]);
            });
        </script>
        

        <!-- Hotjar Tracking Code for https://braspag.github.io/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:715256,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

    </body>
</html>
